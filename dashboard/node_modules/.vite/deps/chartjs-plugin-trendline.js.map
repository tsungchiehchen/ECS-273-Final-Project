{
  "version": 3,
  "sources": ["../../chartjs-plugin-trendline/src/chartjs-plugin-trendline.js"],
  "sourcesContent": ["/*!\r\n * chartjs-plugin-trendline.js\r\n * Version: 2.0.0\r\n *\r\n * Copyright 2022 Marcus Alsterfjord\r\n * Released under the MIT license\r\n * https://github.com/Makanz/chartjs-plugin-trendline/blob/master/README.md\r\n *\r\n * Mod by: vesal: accept also xy-data so works with scatter\r\n */\r\nvar pluginTrendlineLinear = {\r\n    id: 'chartjs-plugin-trendline',\r\n    afterDatasetsDraw: function (chartInstance) {\r\n        var yScale;\r\n        var xScale;\r\n        for (var axis in chartInstance.scales) {\r\n            if (axis[0] == 'x') xScale = chartInstance.scales[axis];\r\n            else yScale = chartInstance.scales[axis];\r\n            if (xScale && yScale) break;\r\n        }\r\n        var ctx = chartInstance.ctx;\r\n\r\n        chartInstance.data.datasets.forEach(function (dataset, index) {\r\n            if (\r\n                dataset.trendlineLinear &&\r\n                chartInstance.isDatasetVisible(index) &&\r\n                dataset.data.length != 0\r\n            ) {\r\n                var datasetMeta = chartInstance.getDatasetMeta(index);\r\n                addFitter(\r\n                    datasetMeta,\r\n                    ctx,\r\n                    dataset,\r\n                    xScale,\r\n                    chartInstance.scales[datasetMeta.yAxisID]\r\n                );\r\n            }\r\n        });\r\n\r\n        ctx.setLineDash([]);\r\n    },\r\n};\r\n\r\nfunction addFitter(datasetMeta, ctx, dataset, xScale, yScale) {\r\n    var defaultColor = dataset.borderColor || 'rgba(169,169,169, .6)';\r\n    var colorMin = dataset.trendlineLinear.colorMin || defaultColor;\r\n    var colorMax = dataset.trendlineLinear.colorMax || defaultColor;\r\n    var lineWidth = dataset.trendlineLinear.width || dataset.borderWidth;\r\n    var lineStyle = dataset.trendlineLinear.lineStyle || 'solid';\r\n    var fillColor = dataset.trendlineLinear.fillColor;\r\n\r\n    lineWidth = lineWidth !== undefined ? lineWidth : 3;\r\n\r\n    var fitter = new LineFitter();\r\n    var firstIndex = dataset.data.findIndex((d) => {\r\n        return d !== undefined && d !== null;\r\n    });\r\n    var lastIndex = dataset.data.length - 1;\r\n    var startPos = datasetMeta.data[firstIndex].x;\r\n    var endPos = datasetMeta.data[lastIndex].x;\r\n    var xy = typeof dataset.data[firstIndex] === 'object';\r\n\r\n    dataset.data.forEach(function (data, index) {\r\n        if (data == null) return;\r\n\r\n        if (xScale.options.type === 'time') {\r\n            var x = data.x != null ? data.x : data.t;\r\n            fitter.add(new Date(x).getTime(), data.y);\r\n        } else if (xy) {\r\n            fitter.add(data.x, data.y);\r\n        } else {\r\n            fitter.add(index, data);\r\n        }\r\n    });\r\n\r\n    var x1 = xScale.getPixelForValue(fitter.minx);\r\n    var y1 = yScale.getPixelForValue(fitter.f(fitter.minx));\r\n\r\n    var x2;\r\n    var y2;\r\n\r\n    // Project only on x axes, do not project if trendline will never hit x axes\r\n    if (dataset.trendlineLinear.projection && fitter.scale() < 0) {\r\n        //  X\r\n        var x2value = fitter.fo();\r\n        if (x2value < fitter.minx) x2value = fitter.maxx;\r\n        x2 = xScale.getPixelForValue(x2value);\r\n\r\n        //  Y\r\n        y2 = yScale.getPixelForValue(fitter.f(x2value));\r\n    } else {\r\n        x2 = xScale.getPixelForValue(fitter.maxx);\r\n        y2 = yScale.getPixelForValue(fitter.f(fitter.maxx));\r\n    }\r\n\r\n    if (!xy) {\r\n        x1 = startPos;\r\n        x2 = endPos;\r\n    }\r\n\r\n    var drawBottom = datasetMeta.controller.chart.chartArea.bottom;\r\n    var chartWidth = datasetMeta.controller.chart.width;\r\n\r\n    if (y1 > drawBottom) {\r\n        // Left side is below zero\r\n        var diff = y1 - drawBottom;\r\n        var lineHeight = y1 - y2;\r\n        var overlapPercentage = diff / lineHeight;\r\n        var addition = chartWidth * overlapPercentage;\r\n\r\n        y1 = drawBottom;\r\n        x1 = x1 + addition;\r\n    } else if (y2 > drawBottom) {\r\n        // right side is below zero\r\n        var diff = y2 - drawBottom;\r\n        var lineHeight = y2 - y1;\r\n        var overlapPercentage = diff / lineHeight;\r\n        var subtraction = chartWidth - chartWidth * overlapPercentage;\r\n\r\n        y2 = drawBottom;\r\n        x2 = chartWidth - (x2 - subtraction);\r\n    }\r\n\r\n    ctx.lineWidth = lineWidth;\r\n    if (lineStyle === 'dotted') {\r\n        ctx.setLineDash([2, 3]);\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n\r\n    var gradient= ctx.createLinearGradient(x1, y1, x2, y2);\r\n    if (y2 < y1) {\r\n        gradient.addColorStop(0, colorMax);\r\n        gradient.addColorStop(1, colorMin);\r\n    } else{\r\n        gradient.addColorStop(0, colorMin);\r\n        gradient.addColorStop(1, colorMax);\r\n    }\r\n    \r\n    ctx.strokeStyle = gradient;\r\n\r\n    ctx.stroke();\r\n    ctx.closePath();\r\n\r\n    if (!!fillColor) {\r\n        ctx.fillStyle = fillColor;\r\n        ctx.beginPath();\r\n        ctx.moveTo(x1, y1);\r\n        ctx.lineTo(x2, y2);\r\n        ctx.lineTo(x2, drawBottom);\r\n        ctx.lineTo(x1, drawBottom);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n}\r\n\r\nfunction LineFitter() {\r\n    this.count = 0;\r\n    this.sumX = 0;\r\n    this.sumX2 = 0;\r\n    this.sumXY = 0;\r\n    this.sumY = 0;\r\n    this.minx = 1e100;\r\n    this.maxx = -1e100;\r\n    this.maxy = -1e100;\r\n}\r\n\r\nLineFitter.prototype = {\r\n    add: function (x, y) {\r\n        x = parseFloat(x);\r\n        y = parseFloat(y);\r\n\r\n        this.count++;\r\n        this.sumX += x;\r\n        this.sumX2 += x * x;\r\n        this.sumXY += x * y;\r\n        this.sumY += y;\r\n        if (x < this.minx) this.minx = x;\r\n        if (x > this.maxx) this.maxx = x;\r\n        if (y > this.maxy) this.maxy = y;\r\n    },\r\n    f: function (x) {\r\n        x = parseFloat(x);\r\n\r\n        var det = this.count * this.sumX2 - this.sumX * this.sumX;\r\n        var offset = (this.sumX2 * this.sumY - this.sumX * this.sumXY) / det;\r\n        var scale = (this.count * this.sumXY - this.sumX * this.sumY) / det;\r\n        return offset + x * scale;\r\n    },\r\n    fo: function () {\r\n        var det = this.count * this.sumX2 - this.sumX * this.sumX;\r\n        var offset = (this.sumX2 * this.sumY - this.sumX * this.sumXY) / det;\r\n        var scale = (this.count * this.sumXY - this.sumX * this.sumY) / det;\r\n\r\n        //  Get x when y = 0\r\n        var xo = -offset / scale;\r\n        return xo;\r\n    },\r\n    scale: function () {\r\n        var det = this.count * this.sumX2 - this.sumX * this.sumX;\r\n        var scale = (this.count * this.sumXY - this.sumX * this.sumY) / det;\r\n\r\n        return scale;\r\n    },\r\n};\r\n\r\n// If we're in the browser and have access to the global Chart obj, register plugin automatically\r\nif (typeof window !== 'undefined' && window.Chart) {\r\n    if (window.Chart.hasOwnProperty('register')) {\r\n        window.Chart.register(pluginTrendlineLinear);\r\n    } else {\r\n        window.Chart.plugins.register(pluginTrendlineLinear);\r\n    }\r\n}\r\n\r\n// Otherwise, try to export the plugin\r\ntry {\r\n    module.exports = exports = pluginTrendlineLinear;\r\n} catch (e) {}\r\n"],
  "mappings": "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",
  "names": []
}
